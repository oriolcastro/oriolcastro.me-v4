---
import TimelineItem from '@/components/timeline/TimelineItem.astro'
import TimelineTOC from '@/components/solid/TimelineTOC'
import { getAllTimeline, sortTimelineAscByYear } from '@/data/timeline'
import PageLayout from '@/layouts/Base.astro'

const allTimelineItems = await getAllTimeline()
const allTimelineItemsByDate = sortTimelineAscByYear(allTimelineItems)
const years = [...new Set(allTimelineItems.map(item => item.data.year))].sort((a, b) => a - b)

const meta = {
  title: 'Timeline',
  description: 'Everything I have achieved during my career',
}
---

<PageLayout meta={meta}>
  <div class="flex w-full flex-col gap-x-10 lg:flex-row lg:items-start">
    <div class="order-1 flex-1 space-y-6">
      <h1 class="title">Timeline</h1>
      <p class="text-justify">
        A year-by-year reflection on the milestones that shaped my career (and life): what I built,
        what worked (and didn’t), and the lessons I’m taking forward.
      </p>
      {allTimelineItemsByDate.map(item => <TimelineItem item={item} />)}
    </div>
    <TimelineTOC years={years} client:load />
  </div>
</PageLayout>
